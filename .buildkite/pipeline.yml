name: "Qwiet preZero Scan"
description: "Pipeline that will perform Qwiet Scanning"
emoji: ":rocket:"
tags: ["appsec"]

env:
  GITHUB_TOKEN: "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"
steps:
  - label: ":white_check_mark: Test"
    command: |
      curl https://cdn.shiftleft.io/download/sl > ./sl && chmod a+rx ./sl
      ./sl analyze --wait --app myApp  --tag branch="$BUILDKITE_BRANCH" .
      echo "====================================="
      echo $${BUILDKITE_REPO}
      echo "====================================="
      echo $${BUILDKITE_PULL_REQUEST}
      echo "====================================="
      echo $${BUILDKITE_BUILD_AUTHOR}
      echo "======================================"
      ./sl check-analysis --v2 --app myApp  --config shiftleft.yml --github-pr-number=$${BUILDKITE_PULL_REQUEST} --github-pr-user=$${BUILDKITE_BUILD_AUTHOR} --github-pr-repo=$${BUILDKITE_REPO} --github-token="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"
    key: QwietScan

